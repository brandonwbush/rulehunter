# Rule Hunter

An adversarial programming challenge where players discover a hidden rule by querying it, submitting their implementation, and defending against failed test cases generated by an AI fuzzer.

## Features

- **60 Mystery Rules** across 3 difficulty levels (20 Easy, 20 Medium, 20 Hard)
- **Query System** - Test up to 20 arrays to discover patterns
- **Hint System** - Request a hint about the rule (with score penalty)
- **Code Sandbox** - Safe execution of player-submitted JavaScript functions
- **Adversarial Fuzzing** - 1000+ test cases to find failures
- **Scoring System** - Points for efficiency and accuracy
- **User Authentication** - Register and track game history
- **UI** - Warm, paper-like theme with IBM Plex fonts

## Tech Stack

- **Next.js 15** (App Router)
- **React 19**
- **TypeScript**
- **Tailwind CSS v4**
- **Vercel Blob Storage** (Session and user data persistence)

## Getting Started

### Local Development

```bash
# Install dependencies
npm install

# Optional: Set up Vercel Blob Storage for persistence
# Copy .env.example to .env.local and add your BLOB_READ_WRITE_TOKEN
# If you don't configure this, data will be stored in local folders (.sessions/, .users/)

# Run development server
npm run dev
```

Open [http://localhost:3000](http://localhost:3000) to play.

### Production Deployment on Vercel

1. **Create a Vercel Blob Store:**
   - Go to your [Vercel Dashboard](https://vercel.com/dashboard)
   - Navigate to your project
   - Go to Storage → Create → Blob
   - Follow the prompts to create a new Blob store

2. **Deploy to Vercel:**
   ```bash
   # Install Vercel CLI if you haven't
   npm i -g vercel

   # Deploy
   vercel
   ```

3. **Connect Blob Storage to your project:**
   - In your Vercel project settings, go to Storage
   - Connect the Blob store you created
   - Vercel will automatically inject the `BLOB_READ_WRITE_TOKEN` environment variable

4. Your app is now production-ready with persistent storage.

### Manual Build and Start

```bash
# Build for production
npm run build

# Start production server
npm start
```

## How to Play

1. **Discovery Phase**: You're given one example array that passes the mystery rule
2. **Query**: Test up to 20 arrays to discover the pattern
3. **Hint** (optional): Request a hint about the rule
4. **Submit**: Write a JavaScript function that implements the rule
5. **Testing**: Your code is tested against 1000+ adversarial test cases
6. **Win**: If no failures are found, you win

## Mystery Rules

The game includes 60 different rules across three difficulty levels:

**Easy (20 rules):**
- Strictly increasing, all even, sum divisible by 3
- All positive, all negative, contains zero
- No duplicates, length even, first equals last
- And many more basic array properties

**Medium (20 rules):**
- Sorted, element ≤ index, alternating odd/even
- Palindrome, majority element, no consecutive duplicates
- Mountain array, zigzag patterns, running sum constraints
- And many more intermediate patterns

**Hard (20 rules):**
- Fibonacci sequence, even number of primes
- Arithmetic or geometric progression
- Bitwise XOR zero, subset sum exists, GCD > 1
- And many more advanced mathematical properties

## Scoring

```
Base Score: 1.00
- Queries: -0.05 per query (first query is free)
- Hints: -0.10 (one hint available per game)
- Submissions: -0.20 per failed submission (first submission is free)
Minimum: 0.00
```

## Project Structure

```
app/
  api/
    auth/            # Authentication endpoints (login, register, token)
    user/            # User data endpoints (history)
    game/            # Game logic and endpoints
      rule.ts        # Rule definitions
      fuzzer.ts      # Test case generation
      sandbox.ts     # Safe code execution
      scoring.ts     # Score calculation
      session.ts     # Session management
      check/         # Query validation endpoint
      hint/          # Hint request endpoint
      new/           # New game creation endpoint
      submit/        # Code submission endpoint
  (game)/            # Main game UI
    components/      # React components
    context/         # React context providers
lib/
  utils.ts           # Utility functions
```

## Future Enhancements

- Leaderboard
- Daily challenge mode
- Multiplayer mode
- More rules
- Rule difficulty rating

## License

MIT
